{
  "hash": "beda61af7d02dc90b7d8e2c8e781b5fd",
  "result": {
    "markdown": "---\ntitle: 'Visualizing Associations among two or more Quantitative Variables'\nauthor: 'Jinwon Lee'\ndate: '2023-06-05'\ncategories: [Visualization, Code, R]\npage-layout: full\nimage: \"./image/scatterplot.png\"\noutput:\n  prettydoc::html_pretty:\n    theme: architect\n    highlight: github\neditor_options: \n  chunk_output_type: console\nmainfont: NanumGothic\n---\n\n\n# 12. Visualizing Associations Among Two or More Quantitative Variables – 여러 정량 변수의 관계 시각화\n\n\n\n\n\n## 12.1 Scatter Plots - 산점도\n\n### Figure 12.1\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Data\nblue_jays <- read.csv('./data/blue_jays.csv')\nblue_jays$KnownSex <- factor(blue_jays$KnownSex, levels = c('F', 'M'))\nblue_jays %>% sapply(class)\n#>      BirdID    KnownSex   BillDepth   BillWidth  BillLength        Head \n#> \"character\"    \"factor\"   \"numeric\"   \"numeric\"   \"numeric\"   \"numeric\" \n#>        Mass       Skull         Sex \n#>   \"numeric\"   \"numeric\"   \"integer\"\nblue_jays %>% head()\n#>       BirdID KnownSex BillDepth BillWidth BillLength  Head  Mass Skull Sex\n#> 1 0000-00000        M      8.26      9.21      25.92 56.58 73.30 30.66   1\n#> 2 1142-05901        M      8.54      8.76      24.99 56.36 75.10 31.38   1\n#> 3 1142-05905        M      8.39      8.78      26.07 57.32 70.25 31.25   1\n#> 4 1142-05907        F      7.78      9.30      23.48 53.77 65.50 30.29   0\n#> 5 1142-05909        M      8.71      9.84      25.47 57.32 74.90 31.85   1\n#> 6 1142-05911        F      7.28      9.30      22.25 52.25 63.90 30.00   0\n\nggplot(blue_jays, aes(Mass, Head)) +\n  geom_point(pch = 21, fill= 'gray25', color = 'white', size = 3) +\n  xlab('Body Mass (g)') +\n  ylab('Head Length (mm)') +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](week14_Visualizing_Association_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n### Figure 12.2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(blue_jays, aes(Mass, Head, fill = KnownSex))  +\n  geom_point(pch = 21, color = 'white', size = 3) +\n  xlab('Body Mass (g)') +\n  ylab('Head Length (mm)') +\n  scale_fill_manual(values = c(F = '#D55E00', M = '#007282'),\n                    breaks = c('F', 'M'),\n                    labels = c('Female Birds   ', 'Male Birds'),\n                    name = NULL,\n                    guide = guide_legend(direction = 'horizontal')) +\n  theme_minimal() +\n  theme(legend.position = 'top',\n        legend.justification = 'right')\n```\n\n::: {.cell-output-display}\n![](week14_Visualizing_Association_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n### Figure 12.3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nblue_jays$sex <- ifelse(blue_jays$KnownSex == 'F', 'Female Birds', 'Male Birds')\nblue_jays$sex <- factor(blue_jays$sex, levels = c('Female Birds', 'Male Birds'))\n\nggplot(blue_jays, aes(Mass, Head, size = Skull, fill = KnownSex)) +\n  geom_point(pch = 21, color = 'white') +\n  facet_wrap(~sex) +\n  xlab('Body Mass (g)') +\n  ylab('Head Length (mm)') +\n  scale_fill_manual(values = c(F = '#D55E00', M = '#007282'), guide = 'none') +\n  scale_radius(name = 'Skull Size (mm)', range = c(2, 7), \n               limits = c(28, 34), breaks = c(28, 30, 32, 34),\n               guide = guide_legend(override.aes = list(fill = 'gray40'))) +\n  theme_minimal() +\n  theme(strip.background = element_rect(fill = 'grey85', colour = 'grey85',\n                                        linetype = 1, size = 0.25))\n#> Warning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.\n#> ℹ Please use the `linewidth` argument instead.\n```\n\n::: {.cell-output-display}\n![](week14_Visualizing_Association_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n### Figure 12.4\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggpairs(blue_jays, columns = 6:8, aes(color = sex)) +\n  theme_light()\n```\n\n::: {.cell-output-display}\n![](week14_Visualizing_Association_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n### Figure 12.6\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload('./data/forensic_glass.rda')\nforensic_glass %>% select(-type, -RI, -Si) %>%\n  ggcorr(palette = 'RdBu', label = TRUE)\n```\n\n::: {.cell-output-display}\n![](week14_Visualizing_Association_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## 12.4 Paired Data - 쌍 데이터\n\n### Figure 12.11\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload('./data/CO2_emissions.rda')\n\nemissions_1970_2010 <- CO2_emissions %>% filter(year %in% c(1970, 2010)) %>% \n  tidyr::spread(year, emissions) %>% \n  na.omit()\n\nggplot(emissions_1970_2010, aes(`1970`, `2010`)) +\n  geom_abline(slope = 1, color = 'grey') +\n  geom_point(pch = 21, fill = '#0072B2D0', color = 'white', size = 3) +\n  scale_x_log10(limits = c(0.008, 125),\n                breaks = c(0.01, 0.1, 1, 10, 100),\n                labels = c('0.01', '0.1', '1.0', '10', '180'),\n                name = parse(text = '`1970 CO`[2]*` emissions (tons / person)`')) +\n  scale_y_log10(limits = c(0.008, 125),\n                breaks = c(0.01, 0.1, 1, 10, 100),\n                labels = c('0.01', '0.1', '1.0', '16', '100'),\n                name = parse(text = '`2010 Co`[2]*` emissions (tons / person)`')) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](week14_Visualizing_Association_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "week14_Visualizing_Association_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}